var e,t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},n={};t.d(n,{L8:()=>G,v7:()=>Z,ni:()=>J,wk:()=>K,R9:()=>W});var r="undefined"==typeof document?void 0:document,o=!!r&&"content"in r.createElement("template"),a=!!r&&r.createRange&&"createContextualFragment"in r.createRange();function i(e,t){var n,r,o=e.nodeName,a=t.nodeName;return o===a||(n=o.charCodeAt(0),r=a.charCodeAt(0),n<=90&&r>=97?o===a.toUpperCase():r<=90&&n>=97&&a===o.toUpperCase())}function d(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var s={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}d(e,t,"selected")},INPUT:function(e,t){d(e,t,"checked"),d(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var o=r.nodeValue;if(o==n||!n&&o==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,o=-1,a=0,i=e.firstChild;i;)if("OPTGROUP"===(r=i.nodeName&&i.nodeName.toUpperCase()))i=(n=i).firstChild;else{if("OPTION"===r){if(i.hasAttribute("selected")){o=a;break}a++}!(i=i.nextSibling)&&n&&(i=n.nextSibling,n=null)}e.selectedIndex=o}}};function l(){}function c(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var u=function(t,n,d){if(d||(d={}),"string"==typeof n)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var u=n;(n=r.createElement("html")).innerHTML=u}else f=(f=n).trim(),n=o?function(e){var t=r.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(f):a?function(t){return e||(e=r.createRange()).selectNode(r.body),e.createContextualFragment(t).childNodes[0]}(f):function(e){var t=r.createElement("body");return t.innerHTML=e,t.childNodes[0]}(f);else 11===n.nodeType&&(n=n.firstElementChild);var f,p=d.getNodeKey||c,v=d.onBeforeNodeAdded||l,m=d.onNodeAdded||l,h=d.onBeforeElUpdated||l,y=d.onElUpdated||l,b=d.onBeforeNodeDiscarded||l,w=d.onNodeDiscarded||l,N=d.onBeforeElChildrenUpdated||l,g=d.skipFromChildren||l,E=d.addChild||function(e,t){return e.appendChild(t)},A=!0===d.childrenOnly,C=Object.create(null),S=[];function T(e){S.push(e)}function L(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=p(n))?T(r):(w(n),n.firstChild&&L(n,t)),n=n.nextSibling}}function U(e,t,n){!1!==b(e)&&(t&&t.removeChild(e),w(e),L(e,n))}function R(e){if(1===e.nodeType||11===e.nodeType)for(var t=e.firstChild;t;){var n=p(t);n&&(C[n]=t),R(t),t=t.nextSibling}}function O(e){m(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=p(t);if(r){var o=C[r];o&&i(t,o)?(t.parentNode.replaceChild(o,t),x(o,t)):O(t)}else O(t);t=n}}function x(e,t,n){var o=p(t);if(o&&delete C[o],!n){var a=h(e,t);if(!1===a)return;if(a instanceof HTMLElement&&R(e=a),function(e,t){var n,r,o,a,i=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var d=i.length-1;d>=0;d--)r=(n=i[d]).name,o=n.namespaceURI,a=n.value,o?(r=n.localName||r,e.getAttributeNS(o,r)!==a&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(o,r,a))):e.getAttribute(r)!==a&&e.setAttribute(r,a);for(var s=e.attributes,l=s.length-1;l>=0;l--)r=(n=s[l]).name,(o=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(o,r)||e.removeAttributeNS(o,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),y(e),!1===N(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,o,a,d,l,c=g(e,t),u=t.firstChild,f=e.firstChild;e:for(;u;){for(d=u.nextSibling,n=p(u);!c&&f;){if(a=f.nextSibling,u.isSameNode&&u.isSameNode(f)){u=d,f=a;continue e}o=p(f);var m=f.nodeType,h=void 0;if(m===u.nodeType&&(1===m?(n?n!==o&&((l=C[n])?a===l?h=!1:(e.insertBefore(l,f),o?T(o):U(f,e,!0),o=p(f=l)):h=!1):o&&(h=!1),(h=!1!==h&&i(f,u))&&x(f,u)):3!==m&&8!=m||(h=!0,f.nodeValue!==u.nodeValue&&(f.nodeValue=u.nodeValue))),h){u=d,f=a;continue e}o?T(o):U(f,e,!0),f=a}if(n&&(l=C[n])&&i(l,u))c||E(e,l),x(l,u);else{var y=v(u);!1!==y&&(y&&(u=y),u.actualize&&(u=u.actualize(e.ownerDocument||r)),E(e,u),O(u))}u=d,f=a}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=p(t))?T(n):U(t,e,!0),t=r}}(e,f,o);var b=s[e.nodeName];b&&b(e,t)}(e,t):s.TEXTAREA(e,t)}R(t);var I,P,V=t,D=V.nodeType,M=n.nodeType;if(!A)if(1===D)1===M?i(t,n)||(w(t),V=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(t,(I=n.nodeName,(P=n.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==P?r.createElementNS(P,I):r.createElement(I)))):V=n;else if(3===D||8===D){if(M===D)return V.nodeValue!==n.nodeValue&&(V.nodeValue=n.nodeValue),V;V=n}if(V===n)w(t);else{if(n.isSameNode&&n.isSameNode(V))return;if(x(V,n,A),S)for(var j=0,k=S.length;j<k;j++){var B=C[S[j]];B&&U(B,B.parentNode,!1)}}return!A&&V!==t&&t.parentNode&&(V.actualize&&(V=V.actualize(t.ownerDocument||r)),t.parentNode.replaceChild(V,t)),V};const f=u,p={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let v;const m=new Uint8Array(16);function h(){if(!v){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");v=crypto.getRandomValues.bind(crypto)}return v(m)}const y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));const b=function(e,t,n){if(p.randomUUID&&!t&&!e)return p.randomUUID();const r=(e=e||{}).random||(e.rng||h)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}(r)};var w={d:(e,t)=>{for(var n in t)w.o(t,n)&&!w.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},N={};w.d(N,{qM:()=>S,E1:()=>C,_u:()=>g,_w:()=>E,Er:()=>A});var g={};w.r(g),w.d(g,{EMPTY_LIST:()=>T,concat:()=>P,cons:()=>L,count:()=>j,filter:()=>I,find:()=>M,fold:()=>O,isEmpty:()=>U,list:()=>R,map:()=>x,prepend:()=>V,reverse:()=>D});var E={};w.r(E),w.d(E,{apply:()=>k,ifNotError:()=>H,ifNotFalse:()=>B});var A={};w.r(A);var C={};w.r(C),w.d(C,{array:()=>_});var S={};w.r(S),w.d(S,{local:()=>q});const T=null,L=(e,t)=>({first:e,rest:t}),U=e=>T===e,R=(...e)=>e.reduce(((e,t)=>L(t,e)),T),O=(e,t,n)=>U(e)?n:t(e.first,O(e.rest,t,n)),x=(e,t)=>O(e,((e,n)=>L(t(e),n)),T),I=(e,t)=>O(e,((e,n)=>t(e)?L(e,n):n),T),P=(e,t)=>O(e,L,t),V=(e,t)=>P(e,R(t)),D=e=>O(e,((e,t)=>V(t,e)),T),M=(e,t)=>!U(e)&&(t(e.first)?e.first:M(e.rest,t)),j=e=>U(e)?0:j(e.rest)+1,k=e=>(t,n)=>e(t)?t:n(t),B=k((e=>!1===e)),H=k((e=>e instanceof Error)),_=(e,t)=>Array.apply(null,Array(e)).map(((e,n)=>t(n))),q=(e,t)=>t(e);var z=N.qM;const{local:F}=z;class X extends HTMLElement{}customElements.define("reactor-viewport",X);const G=e=>F({state:e.initialState,root:e.render(e.initialState)},(t=>F((n=>{if(t.state!==n){t.state=n;const r=e.render(t.state);t.root.isEqualNode(r)||(t.root.nodeName!==r.nodeName?(t.root.replaceWith(r),t.root=r):f(t.root,r,{getNodeKey:e=>e instanceof X?e.dataset.id:e.id,onBeforeNodeAdded:e=>e instanceof X&&e.classList.contains("stub")?e.reference.deref():e,onBeforeElUpdated:(e,t)=>!e.isEqualNode(t)&&(!(t instanceof X)||(t.classList.contains("viewport")?t:t.reference.deref()))}))}}),(n=>F(document.createElement("reactor-viewport"),(r=>((e,t)=>(e.shadowRoot.appendChild(e.data.root),t.styles&&e.shadowRoot.adoptedStyleSheets.push(t.styles),e))({data:t,id:b(),viewport:r,shadowRoot:r.attachShadow({mode:"open"}),events:e.events,localListener:r=>{["submit"].includes(r.type)&&r.preventDefault(),r.stopImmediatePropagation();const o=e.events.local[r.type];n(o(t.state,r))},windowListener:r=>{const o=e.events.window[r.type];n(o(t.state,r))},documentListener:r=>{const o=e.events.document[r.type];n(o(t.state,r))},running:!1},e))))))),K=e=>e.data.state,W=e=>{if(!e.viewport.isConnected)return e.viewport.classList.add("viewport"),e.viewport.dataset.id=e.id,e.viewport;const t=document.createElement("reactor-viewport");return t.classList.add("stub"),t.dataset.id=e.id,t.reference=new WeakRef(e.viewport),t},Y=(e,t,n)=>Object.keys(e).forEach((e=>t.addEventListener(e,n,!0))),J=e=>(Y(e.events?.local??{},e.shadowRoot,e.localListener),Y(e.events?.window??{},window,e.windowListener),Y(e.events?.document??{},document,e.documentListener),{...e,running:!0}),Q=(e,t,n)=>Object.keys(e).forEach((e=>t.removeEventListener(e,n,!0))),Z=e=>(Q(e.events?.local??{},e.shadowRoot,e.localListener),Q(e.events?.window??{},window,e.windowListener),Q(e.events?.document??{},document,e.documentListener),{...e,running:!1});var $=n.L8,ee=n.v7,te=n.ni,ne=n.wk,re=n.R9;export{$ as make,ee as pause,te as start,ne as state,re as viewport};